<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Firebase Test</title>

  <!-- Firebase SDK 추가 -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
  
  <script>
    // Firebase 설정 (Firebase Console에서 제공하는 설정 값을 복사해 넣기)
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    // Firebase 초기화
    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database(); // Firebase 실시간 데이터베이스 참조
  </script>
</head>
<body>
  <h1>Firebase와 연결된 웹사이트</h1>

  <script>
    // 고유 사용자 ID 생성 (랜덤 문자열)
    function getUniqueUserId() {
      return 'user_' + Math.random().toString(36).substr(2, 9);
    }

    // Firebase에 사용자 데이터 저장
    function saveUserData(userId, data) {
      const userRef = database.ref('users/' + userId);
      userRef.set({
        timestamp: new Date().toISOString(), // 방문 시간
        ...data
      })
      .then(() => {
        console.log('User data saved successfully');
      })
      .catch((error) => {
        console.error('Error saving user data:', error);
      });
    }

    // 웹사이트 방문 시 사용자 데이터 추적 및 저장
    window.onload = function() {
      const userId = getUniqueUserId(); // 고유 사용자 ID 생성

      // 사용자 데이터 추적
      const userData = {
        page: window.location.href, // 현재 방문한 페이지 URL
        device: navigator.userAgent, // 사용자의 디바이스 정보 (예: 브라우저, OS)
        referrer: document.referrer // 이전 페이지(참조자) 정보
      };

      // Firebase에 사용자 데이터 저장
      saveUserData(userId, userData);
    };
  </script>
  <script src="firebaseConfig.js"></script>
</body>
</html>
